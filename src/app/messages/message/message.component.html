<form [formGroup]="messageForm" (ngSubmit)="onSubmit()" class="ui form">
  <div class="edit-grid" *ngIf="isLoaded">
    <div class=" ui segment header-segment">
      <div class="ui header">
        {{ message.fileName }}
        <div class="ui sub header">{{ message.lines.length }} lines</div>
      </div>
      <select class="chapter-select" formControlName="chapterName">
        <option *ngFor="let item of chapters" [ngValue]="item">{{ item }}</option>
      </select>
      <div class="ui label" *ngFor="let name of message.names">
        {{ name.japanese }} <span *ngIf="!!name.english">({{ name.english }})</span>
      </div>
    </div>
    <app-navigation class="navigation" [next]="message.nextMessageId" [prev]="message.prevMessageId"></app-navigation>
    <div class="edit-form" formArrayName="lines">
      <div class="ui segment" *ngFor="let line of getControls(); let i = index" [formGroupName]="i">
        <div class="ui two column stackable grid">
          <div class="column">
            <h4>Japanese</h4>
            <pre class="game-text">
              {{ message.lines[i].text.japanese }}
            </pre>
          </div>
          <div class="column field">
            <div class="english-name-title">
              <h4>English</h4>
              <span class="mini ui button primary icon" (click)="onPreview(i)"><i class="ui icon eye"> </i> </span>
            </div>
            <textarea formControlName="english" rows="4"></textarea>
          </div>
        </div>
      </div>
    </div>
    <app-navigation class="navigation" [next]="message.nextMessageId" [prev]="message.prevMessageId"></app-navigation>
  </div>
</form>
<app-preview></app-preview>
